<!DOCTYPE HTML>
<html>
  <head>
    <script src="jquery-2.1.4.min.js"></script>
  </head>
  <body>
    <form action="/" method="GET">
      <input type="text" name="device" value="8">
      <input type="text" name="command" value="">
      <input type="submit" value="Send">
    </form>
    <form id="mainForm" action="/" method="GET" style="display: none">
      <input id="deviceID" type="hidden" name="device" value="">
      <input id="deviceMSG" type="hidden" name="command" value="">
    </form>
    <h3>Door Controller</h3>
    <button onclick="sendMessage(3,'*STAT?')">Status</button>
    <button onclick="sendMessage(3,'*IDN?')">Identify</button>
    <button onclick="sendMessage(3,'*SET_PROG=-1')">Set Off</button>
    <button onclick="sendMessage(3,'*SET_PROG=0')">Set Start</button>
    <button onclick="sendMessage(3,'*SET_PROG=75')">Set 25%</button>
    <button onclick="sendMessage(3,'*SET_PROG=150')">Set 50%</button>
    <button onclick="sendMessage(3,'*SET_PROG=225')">Set 75%</button>
    <button onclick="sendMessage(3,'*SET_PROG=300')">Set Complete</button>
    <button onclick="sendMessage(3,'*SET_BRIG=10')">Set Low</button>
    <button onclick="sendMessage(3,'*SET_BRIG=64')">Set 25%</button>
    <button onclick="sendMessage(3,'*SET_BRIG=128')">Set 50%</button>
    <button onclick="sendMessage(3,'*SET_BRIG=192')">Set 75%</button>
    <button onclick="sendMessage(3,'*SET_BRIG=255')">Set Bright</button>
    <table>
      <tr>
        <th>Command:</th>
        <td><form onsubmit="return false;"><input type="text" id="3_cmd"><button type="submit" onclick="sendMessage(3, document.getElementById('3_cmd').value)">Send</button></form></td>
      </tr>
      <tr>
        <th>Response:</th>
        <td><span id="3_resp"></span></td>
      </tr>
    </table>

    <h3>Geiger Counter</h3>
    <button onclick="sendMessage(7,'*STAT?')">Status</button>
    <button onclick="sendMessage(7,'*IDN?')">Identify</button>
    <button onclick="sendMessage(7,'*RST')">Reset</button>
    <table>
      <tr>
        <th>Command:</th>
        <td><form onsubmit="return false;"><input type="text" id="7_cmd"><button type="submit" onclick="sendMessage(7, document.getElementById('7_cmd').value)">Send</button></form></td>
      </tr>
      <tr>
        <th>Response:</th>
        <td><span id="7_resp"></span></td>
      </tr>
    </table>

    <h3>Morse Code Interpreter</h3>
    <button onclick="sendMessage(5,'*STAT?')">Status</button>
    <button onclick="sendMessage(5,'*IDN?')">Identify</button>
    <button onclick="sendMessage(5,'*RST')">Reset</button>
    <button onclick="sendMessage(5,'*MSG=SOS')">Message = SOS</button>
    <button onclick="sendMessage(5,'*MSG=CATS')">Message = CATS</button>
    <table>
      <tr>
        <th>Command:</th>
        <td><form onsubmit="return false;"><input type="text" id="5_cmd"><button type="submit" onclick="sendMessage(5, document.getElementById('5_cmd').value)">Send</button></form></td>
      </tr>
      <tr>
        <th>Response:</th>
        <td><span id="5_resp"></span></td>
      </tr>
    </table>

    <h3>Telephone Exchange</h3>
    <button onclick="sendMessage(9,'*STAT?')">Status</button>
    <button onclick="sendMessage(9,'*IDN?')">Identify</button>
    <button onclick="sendMessage(9,'*RST')">Reset</button>
    <button onclick="sendMessage(9,'*TRIG')">Trigger</button>
    <button onclick="sendMessage(9,'*COMBO=2')">Combination = 2</button>
    <button onclick="sendMessage(9,'*COMBO=12')">Combination = 4 + 8</button>
    <table>
      <tr>
        <th>Command:</th>
        <td><form onsubmit="return false;"><input type="text" id="9_cmd"><button type="submit" onclick="sendMessage(9, document.getElementById('9_cmd').value)">Send</button></form></td>
      </tr>
      <tr>
        <th>Response:</th>
        <td><span id="9_resp"></span></td>
      </tr>
    </table>

    <script type="text/javascript">
    function sendMessage(id, msg) {
      $.ajax({
        url: "http://device.roomserver.io?device="+id+"&command="+msg,
        complete: processResponse,
        datatype: 'json',
        type: 'GET',
        timeout: 1500
      });
    }
    function processResponse(xhr, status) {
      if (status == "success") {
        rsp = xhr.responseJSON;
        $("#"+rsp.device+"_resp").html(rsp.response);
        $("#"+rsp.device+"_cmd").val(rsp.command);
      }
      else {
        alert("Failed to communicate with room controller");
      }
    }
    </script>
    <h2>Command</h2>
    <pre>
    </pre>
    <h2>Response</h2>
    <pre>
    </pre>
  </body>
</html>